---
title: 华为路由器配置telnet/stelnet远程登录
date: 2021-11-02T01:31:08+00:00
categories:
  - 网络
tags:
  - stelnet
  - telnet
---

## 1、网络拓扑

![](https://objects.wangaiguo.com/wp-content/uploads/2021/11/image.png)

实验采用ENSP模拟器，设备IP信息如下图所示

![](https://objects.wangaiguo.com/wp-content/uploads/2021/11/image-1.png)

## 2、telnet登录配置

### 2.1 密码认证

```
<R1>system-view
Enter system view, return user view with Ctrl+Z.
[R1]user-interface vty 0 4
[R1-ui-vty0-4]authentication-mode password
Please configure the login password (maximum length 16):huawei
[R1-ui-vty0-4]user privilege level 1
[R1-ui-vty0-4]quit
```

这里设置用户级别为 1，详细的命令级别如下所示：

![](https://objects.wangaiguo.com/wp-content/uploads/2021/11/image-3.png)

> 用户权限分为0-15共16个级别。默认情况下，3级用户就可以操作VRP系统的所有命令，也就是说4-15级的用户权限在默认情况下是与3级用户权限一致的。4~15级的用户权限一般与提升命令级别的功能一起使用，例如当设备管理员较多时，需要在管理员中再进行权限细分，这时可以将某条关键命令所对应的用户级别提高，如提高到15级，这样一来，缺省的3级管理员便不能再使用该关键命令。

R2使用telnet登录R1，**telnet 10.1.1.254**

![](https://objects.wangaiguo.com/wp-content/uploads/2021/11/image-2.png)

### 2.2 AAA认证

默认情况下，设备的AAA认证功能是开启的，所以只需要为管理员在本地配置相应的用户名和密码即可。

```
<R1>system-view
Enter system view, return user view with Ctrl+Z.
[R1]aaa
[R1-aaa]local-user admin password cipher hello privilege level 3
[R1-aaa]local-user admin service-type telnet
[R1-aaa]user-interface vty 0 4
[R1-ui-vty0-4]authentication-mode aaa
```

R2使用telnet登录R1，**telnet 10.1.1.254** ，可以看到需要输入用户名，密码，并且配置了Level 3用户级别，可以使用管理命令

![](https://objects.wangaiguo.com/wp-content/uploads/2021/11/image-5.png)

## 3 SSH Telnet登录配置

SSH Telnet（简称Stelnet），在华为的网络设备上，它只是"SSH"的另一种叫法（而实际Stelnet和SSH的区别也只是叫法上不同而已），其目的是为了让早期网工借助大名鼎鼎的 telnet 了解 Stelnet 采用了加密传输，是一种更安全的远程登录方式。从而这一命名延续至今，其他品牌网络设备并无这一说法。

### 3.1 生成密钥对

```
[R2]rsa local-key-pair create 
The key name will be: Host
% RSA keys defined for Host already exist.
Confirm to replace them? (y/n)[n]:y
The range of public key size is (512 ~ 2048).
NOTES: If the key modulus is greater than 512,
       It will take a few minutes.
Input the bits in the modulus[default = 512]:
Generating keys...
.........++++++++++++
..++++++++++++
...............++++++++
.++++++++
```

### 3.2 配置VYT、AAA授权验证

```
[R2]user-interface vty 0 4
[R2-ui-vty0-4]authentication-mode aaa
[R2-ui-vty0-4]protocol inbound ssh
[R2-ui-vty0-4]quit
[R2]aaa
[R2-aaa]local-user huawei password cipher privelege level 3
Info: Add a new user.
[R2-aaa]local-user huawei service-type ssh
[R2-aaa]ssh user huawei authentication-type password
 Authentication type setted, and will be in effect next time
[R2]stelnet server enable
Info: Succeeded in starting the STELNET server.
[R2]display ssh user-information huawei
 -------------------------------------------------------------------------------

 Username         Auth-type          User-public-key-name
 -------------------------------------------------------------------------------
 huawei           password           null                           
 ------------------------------------------------------------------------
[R2]display ssh server status
 SSH version                         :1.99  
 SSH connection timeout              :60 seconds
 SSH server key generating interval  :0 hours
 SSH Authentication retries          :3 times
 SFTP Server                         :Disable
 Stelnet server                      :Enable
```

### 3.3 客户端SSH登录设置

```
<R2>system-view
Enter system view, return user view with Ctrl+Z.
[R2]ssh client first-time enable
[R2]stelnet 10.1.1.2
Please input the username:huawei
Trying 10.1.1.2 ...
Press CTRL+K to abort
Connected to 10.1.1.2 ...
The server is not authenticated. Continue to access it? (y/n)[n]:y
Save the server's public key? (y/n)[n]:y
The server's public key will be saved with the name 10.1.1.2. Please wait...

Enter password:
  ----------------------------------------------------------------------------- 
    
  User last login information:     
  -----------------------------------------------------------------------------
  Access Type: SSH      
  IP-Address : 10.1.1.1 ssh     
  Time       : 2021-11-02 10:56:27-08:00     
  ----------------------------------------------------------------------
